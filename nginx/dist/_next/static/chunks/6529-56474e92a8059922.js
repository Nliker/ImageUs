"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6529],{6529:function(e,t,n){n.d(t,{Z:function(){return g}});var r=n(7311),i=n(2265),a=n(7263),o=n(1172),l=n(3560),s=n(5137),c=n(442),d=n(2333),u=n(4903),p=n(2164),f=n(6339);let h=async e=>{try{let t=await u.Z.get(e),n=t.data.result,r=n.slice(0,5);return[...r]}catch(e){if(window.navigator.onLine){if(e instanceof p.d7)(401===e.status||403===e.status)&&console.error("Error: 올바른 요청이 아닙니다..다시시도 해주세요!");else throw new f.U7}throw new f.F7}};var m=n(8067),v=n(9509);function g(){let[e,t]=(0,i.useState)(),[n,u]=(0,i.useState)(""),[p,f]=(0,i.useState)(!1),[m,g,y]=(0,c.Z)(""),{addFriend:k}=(0,s.y)(),{data:Z}=function(e){let{data:t,isLoading:n,error:r}=(0,d.ZP)("/user/search?email=".concat(e),h,{fallbackData:[],revalidateOnFocus:!1,revalidateOnMount:!1,revalidateOnReconnect:!1,keepPreviousData:!0});return{data:t,isLoading:n,error:r}}(n);(0,i.useEffect)(()=>{let e=setTimeout(()=>{u(m)},300);return()=>clearTimeout(e)},[m]);let B=(0,i.useCallback)(e=>{e.preventDefault();let n=null==Z?void 0:Z.find(e=>e.email===m);t(n)},[m,Z]),N=(0,i.useCallback)(e=>()=>{var n;if(null==e?void 0:e.id){g(null!==(n=e.email)&&void 0!==n?n:""),f(!1);let r=null==Z?void 0:Z.find(t=>t.id===e.id);t(r)}},[Z,g]);return(0,r.BX)(x,{children:[(0,r.BX)(w,{children:[(0,r.BX)("form",{onSubmit:B,children:[(0,r.BX)("div",{className:"search_input",children:[(0,r.tZ)("label",{htmlFor:"searchFriend",children:"Search"}),(0,r.tZ)("input",{type:"text",id:"searchFriend",name:"search",autoComplete:"off",placeholder:"이메일을 입력하세요..",onChange:y,onFocus:()=>f(!0),onBlur:()=>f(!1),value:m})]}),(0,r.tZ)("div",{className:"search_btn",children:(0,r.tZ)(v.z,{type:"submit",children:"검색"})})]}),p&&(0,r.tZ)(b,{children:Z&&(null==Z?void 0:Z.length)!==0?(0,r.tZ)("ul",{className:"preview_data",children:(0,r.tZ)(a.ZP,{children:Z.map(e=>(0,r.tZ)("li",{className:"preview_item",onMouseDown:N(e),children:(0,r.BX)("div",{className:"search_result_space",children:[(0,r.BX)("span",{children:["이름: ",e.name]}),(0,r.BX)("span",{children:["이메일: ",e.email]}),(0,r.BX)("span",{children:["가입유형: ",e.user_type]})]})},e.id))})}):(0,r.tZ)("div",{className:"no_data",children:(0,r.tZ)("p",{children:"검색 결과가\n없습니다."})})})]}),(0,r.BX)(_,{children:[(0,r.tZ)("h3",{children:"검색결과"}),e?(0,r.BX)("div",{className:"result_box",children:[(0,r.BX)("div",{className:"result_data",children:[(0,r.BX)("p",{children:["이름:",(0,r.tZ)("span",{className:"item",children:null==e?void 0:e.name})]}),(0,r.BX)("p",{children:["이메일:",(0,r.tZ)("span",{className:"item",children:null==e?void 0:e.email})]})]}),(0,r.tZ)("div",{className:"button_group",children:(0,r.tZ)(v.z,{type:"button",onClick:async()=>{await k(e.id)},children:"친구 추가하기"})})]}):(0,r.BX)("div",{className:"not_found",children:[(0,r.tZ)(o.Pd.Provider,{value:{size:"100px",style:{display:"inline-block"}},children:(0,r.tZ)(l.Xtm,{})}),(0,r.tZ)("div",{className:"not_found_text",children:(0,r.tZ)("span",{children:"검색 결과가 없습니다."})})]})]})]})}let x=(0,m.Z)("div",{target:"e17y8tfw0"})("\r\n    display:flex;flex-direction:column;align-items:center;width:100%;height:100%;box-sizing:border-box;p{margin:0;}form{position:relative;display:flex;justify-content:space-between;align-items:center;text-align:left;height:60px;padding:0 20px;border-radius:30px;background:#fff;box-shadow:0px 0px 5px 0px rgb(0 0 0 / 19%);.search_btn{padding-left:10px;button{width:60px;font-size:0.5rem;}}}form .search_input{width:100%;margin-left:10px;label{position:absolute;display:block;z-index:1;font-size:12px;font-weight:bold;}input{width:100%;border:0;padding:20px 0 0;}input:focus{outline:none;&::placeholder{color:transparent;}}}"),w=(0,m.Z)("div",{target:"e17y8tfw1"})("\r\n    position:relative;top:5px;width:70%;max-width:700px;min-width:260px;margin:0 1rem;"),b=(0,m.Z)("div",{target:"e17y8tfw2"})("\r\n    position:absolute;width:calc(100% - 40px);margin-left:20px;border-radius:5px;box-shadow:rgb(0 0 0 / 30%) 0px 8px 12px 0px;background-color:white;.preview_data{height:200px;padding:0;.preview_item{padding:1rem;font-size:1rem;border-bottom:1px solid #e9ecef;&:hover{background-color:#f7f7f9;cursor:pointer;}.search_result_space{display:flex;flex-direction:column;justify-content:center;gap:0.3rem;}}}.no_data{height:40px;text-align:center;p{position:relative;top:50%;transform:translateY(-50%);}}@media screen and (max-width:300px){.no_data{height:50px;white-space:pre-line;}}"),_=(0,m.Z)("div",{target:"e17y8tfw3"})("\r\n    width:100%;margin-top:30px;h3{text-align:center;}.result_box{display:flex;flex-direction:column;align-items:center;margin-top:15px;gap:1.5rem;.result_data{display:flex;flex-direction:column;justify-content:center;gap:1rem;.item{font-weight:bolder;}}.button_group{display:flex;justify-content:center;gap:1rem;}@media screen and (max-width:340px){.button_group{flex-direction:column;}}}.not_found{max-width:500px;padding:1rem 0;margin:auto;text-align:center;.not_found_text{margin-top:20px;}}")},9509:function(e,t,n){n.d(t,{z:function(){return i}});var r=n(8067);let i=(0,r.Z)("button",{target:"e8c3pr40"})("\r\n    -webkit-appearance:none;-moz-appearance:none;appearance:none;background:","#446cb3",";color:","#ffffff",";margin:0;padding:0.5rem 1rem;font-size:1rem;font-weight:400;text-align:center;text-decoration:none;border:none;border-radius:4px;display:inline-block;width:auto;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1),0 2px 4px -1px rgba(0,0,0,0.06);cursor:pointer;transition:0.5s;&:hover,&:active,&:focus{background:","#365690",";outline:0;}&:disabled{opacity:0.5;}&.success{background:","#28a745",";&:hover,&:active,&:focus{background:","#218838",";outline:0;}&:disabled{opacity:0.5;}}&.error{background:","#dc3545",";&:hover,&:active,&:focus{background:","#c82333",";outline:0;}&:disabled{opacity:0.5;}}&.warning{color:","#212529",";background:","#ffc107",";&:hover,&:active,&:focus{background:","#e0a800",";outline:0;}&:disabled{opacity:0.5;}}")},5137:function(e,t,n){n.d(t,{y:function(){return d}});var r=n(2164),i=n(6881),a=n(7262),o=n(6494),l=n(4903),s=n(6339),c=n(2472);function d(){let[e,t]=(0,o.v$)(),[n,d]=(0,i.ZP)({key:"".concat(o.wy,"-loading"),initial:!0}),[u,,p]=(0,i.ZP)({key:o.wy,initial:null,persistor:{onSet:a.Z.onSet,onGet:async e=>{try{let e=await (0,c.L)(),n=a.Z.onGet(o.sB),r=await l.Z.get("/user/".concat(n.user_info.id,"/friendlist"),{headers:{Authorization:e.access_token}}),i=r.data.friendlist;return t(e=>({...e,friends:[...i]})),i}catch(e){if(window.navigator.onLine){if(h instanceof r.d7){var n,i;((null===(n=h.response)||void 0===n?void 0:n.status)===401||(null===(i=h.response)||void 0===i?void 0:i.status)===403)&&alert("올바른 요청이 아닙니다..다시시도 해주세요!")}else throw new s.U7}throw new s.F7}finally{d(!1)}}}}),{mutate:f,error:h}=p,m=async t=>{var n,i,a,o,u;try{d(!0);let r=await (0,c.L)(),i=null==e?void 0:null===(n=e.user_info)||void 0===n?void 0:n.id,a=await l.Z.post("/user/".concat(i,"/friend"),{friend_user_id:t},{headers:{Authorization:r.access_token}});if("0명 친구 생성 성공"===a.data){let e=Error("자기 자신을 친구로 추가할 수 없습니다...");throw e.name="AddMyAccount",e}f(),alert("성공적으로 추가하였습니다!"),d(!1)}catch(e){if(e instanceof r.d7){if((null===(i=e.response)||void 0===i?void 0:i.status)===401||(null===(a=e.response)||void 0===a?void 0:a.status)===403)alert("올바른 요청이 아닙니다..다시시도 해주세요!");else if((null===(o=e.response)||void 0===o?void 0:o.status)===402)alert("이미 등록된 유저입니다.");else if((null===(u=e.response)||void 0===u?void 0:u.status)===404)alert("해당 유저가 존재하지 않습니다..관리자에게 문의하세요!");else throw new s.U7}else if(e instanceof Error)"AddMyAccount"===e.name&&alert(e.message);else throw new s.U7}},v=async t=>{var n,i,a,o;try{d(!0);let r=await (0,c.L)(),i=null==e?void 0:null===(n=e.user_info)||void 0===n?void 0:n.id;await l.Z.delete("/user/".concat(i,"/friend"),{headers:{Authorization:r.access_token},data:{delete_friend_user_id:t}}),await f(),alert("성공적으로 친구목록에서 삭제하였습니다!"),d(!1)}catch(e){if(e instanceof r.d7)(null===(i=e.response)||void 0===i?void 0:i.status)===401||(null===(a=e.response)||void 0===a?void 0:a.status)===403?alert("올바른 요청이 아닙니다..다시시도 해주세요!"):(null===(o=e.response)||void 0===o?void 0:o.status)===404&&alert("해당 유저가 존재하지 않습니다..관리자에게 문의하세요!");else throw new s.U7}};return{data:u,isLoading:n,error:h,addFriend:m,deleteMember:v}}},442:function(e,t,n){var r=n(2265);t.Z=e=>{let[t,n]=(0,r.useState)(e),i=(0,r.useCallback)(e=>{n(e.target.value)},[]);return[t,n,i]}},4903:function(e,t,n){var r=n(9222);let i=r.default.create({baseURL:"https://codakcodak.site/backapi"});t.Z=i},6339:function(e,t,n){n.d(t,{F7:function(){return r},U7:function(){return i}});class r extends Error{constructor(e="연결되 네트워크가 없습니다."){super(e),this.name="NetworkError"}}class i extends Error{constructor(e="예기치 못한 에러가 발생하였습니다..다시 시도해주세요."){super(e),this.name="unknownError"}}},7262:function(e,t){t.Z={onSet(e,t){let n=JSON.stringify(t);localStorage.setItem(String(e),n)},onGet(e){var t;let n=null!==(t=localStorage.getItem(String(e)))&&void 0!==t?t:"null";try{return JSON.parse(n)}catch(e){return n}}}},6494:function(e,t,n){n.d(t,{B1:function(){return a},EE:function(){return l},sB:function(){return o},v$:function(){return d},wy:function(){return s},zV:function(){return c},zW:function(){return u}});var r=n(6881),i=n(7262);let a="@user/token",o="@user/info",l="@user/room",s="@user/friend",c="@user/image",d=(0,r.MT)({key:o,initial:{loginState:"loading"},persistor:i.Z}),u=(0,r.MT)({key:"".concat(c,"-imagelist"),initial:null})},2472:function(e,t,n){n.d(t,{L:function(){return l}});var r=n(9222),i=n(2164),a=n(7262),o=n(6494);let l=async()=>{try{let e=new Date,t=a.Z.onGet(o.B1),n=null==t?void 0:t.access_token,i=null==t?void 0:t.refresh_token,l=null==t?void 0:t.access_token_expire_time,s=null==t?void 0:t.refresh_token_expire_time;if(!l||!s||!n)return null;let c=new Date(l),d=c.getTime()-e.getTime(),u=new Date(s),p=u.getTime()-e.getTime();if(d>=3e4)return t;if(!(p>=3e4))return null;{let e=a.Z.onGet(o.sB),n=null==e?void 0:e.user_info.id,l=await r.default.post("/backapi/user/".concat(n,"/refresh"),{refresh_token:i}),s=l.data;return a.Z.onSet(o.B1,{...t,...s}),s}}catch(e){return e instanceof i.d7?console.error("Error: 사용자 권한을 갱신하지 못하였습니다..",e):console.error("Error: ",e),null}}}}]);
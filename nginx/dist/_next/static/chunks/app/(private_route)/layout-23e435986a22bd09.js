(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4234],{4994:function(e,t,n){Promise.resolve().then(n.bind(n,2224))},2224:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return A}});var r,i=n(7311),o=n(2265),a=n(7263),l=n(9150),s=n(8067),c=n(1172),d=n(3159),u=n(4033),h=n(1691),p=n(7267),g=n(8574),m=n(4606),v=n(8920),f=n(6820),w=n(3787),y=n(6494),x=n(452),_=n(8131),Z=n.n(_);function k(){var e;let[t,n]=(0,y.v$)(),r=(0,u.useRouter)(),a=(0,u.usePathname)(),[l,s]=(0,o.useState)(!1),_=(null==t?void 0:t.currentPage)===w.L.RoomMain,k=async()=>{await n({loginState:"logout"}),(0,x.RN)()};return(0,i.tZ)(b,{children:(0,i.BX)(c.Pd.Provider,{value:{size:"16px"},children:[(0,i.tZ)(N,{children:(0,i.BX)("button",{className:"left_btn",onClick:_?()=>{r.push("/room/create_room")}:()=>r.push("/room"),children:[(0,i.tZ)("div",{className:"list_icon",children:_?(0,i.tZ)(m.O$v,{}):(0,i.tZ)(p.eSk,{})}),(0,i.tZ)("div",{className:"list_text",children:_?"방 생성하기":"방 목록으로 이동"})]})}),(0,i.tZ)("h2",{className:Z().className,children:null==t?void 0:t.navigationTitle}),(0,i.BX)(B,{children:[(null==t?void 0:t.currentPage)===w.L.ImageRoom&&(0,i.BX)(i.HY,{children:[(0,i.tZ)("div",{className:"upload_icon icon_d",onClick:()=>r.push(a+"/upload_image"),children:(0,i.tZ)(f.AM0,{})}),(0,i.tZ)("div",{className:"invite_icon icon_d",onClick:()=>r.push(a+"/invite_member"),children:(0,i.tZ)(v.zy7,{})})]}),(0,i.tZ)("div",{className:"user_name",children:null==t?void 0:null===(e=t.user_info)||void 0===e?void 0:e.name}),(0,i.tZ)("div",{className:"user_icon icon_d",onClick:()=>s(e=>!e),children:(0,i.tZ)(d.BKo,{})}),l&&(0,i.BX)(i.HY,{children:[(0,i.tZ)("div",{className:"backdrop",onClick:()=>s(!1)}),(0,i.BX)("div",{className:"user_icon_menu",children:[(0,i.BX)("div",{className:"menu_item",onClick:()=>{s(!1),r.push("/my_page")},children:[(0,i.tZ)(g.l3d,{}),(0,i.tZ)("span",{className:"text",children:"마이페이지"})]}),(0,i.BX)("div",{className:"menu_item logout",onClick:k,children:[(0,i.tZ)(h.u43,{}),(0,i.tZ)("span",{className:"text",children:"로그아웃"})]})]})]})]})]})})}let b=(0,s.Z)("nav",{target:"e18syg5z0"})("\r\n    display:flex;justify-content:space-between;align-items:center;padding:0 1.5rem;height:50px;border-bottom:1px solid hsl(210,8%,85%);box-sizing:border-box;h2{margin:0;white-space:nowrap;}ul{padding:0;margin:0;list-style:none;a{text-decoration:none;}}"),N=(0,s.Z)("div",{target:"e18syg5z1"})("\r\n    display:flex;.create_room_btn{padding:7px;border-radius:50%;background-color:lightgray;cursor:pointer;&:hover{background-color:darkgray;}}.left_btn{position:relative;display:inline-flex;justify-content:center;align-items:center;padding:7px;vertical-align:middle;overflow:hidden;text-decoration:none;white-space:nowrap;user-select:none;background:none;background-color:hsla(240,7%,70%,0.22);color:#0e0e10;font-weight:600;border:none;border-radius:0.4rem;cursor:pointer;&:hover{background-color:hsla(240,7%,70%,0.35);}.list_icon{line-height:0;margin-right:3px;}@media screen and (max-width:700px){svg{width:20px;height:20px;}.list_icon{margin:0;}.list_text{position:absolute;width:1px;height:1px;clip-path:polygon(0 0,0 0,0 0,0 0);overflow:hidden;}}}"),B=(0,s.Z)("div",{target:"e18syg5z2"})("\r\n    display:flex;align-items:center;.icon_d{display:inline-block;margin-left:auto;margin-right:15px;padding:7px;border-radius:50%;background-color:lightgray;cursor:pointer;&:hover{background-color:darkgray;}}.user_name{margin:0 1rem;white-space:nowrap;}.backdrop{width:100vw;height:100vh;position:fixed;left:0;top:0;z-index:9;visibility:visible;}.user_icon_menu{position:absolute;top:44px;right:20px;z-index:10;width:140px;text-align:center;border-radius:8px;box-shadow:0px 1px 1px 1px rgba(0,0,0,0.2);background-color:white;overflow:hidden;.menu_item{padding:12px;cursor:pointer;&:hover{background-color:#e6e6e6;}&:not(:last-child){border-bottom:1px solid #f2f2f2;}.text{margin-left:3px;}}.menu_item.logout{&:hover{color:white;background-color:#f07070;}}}");var S=n(1396),z=n.n(S),E=n(8760);function L(e){let{show:t}=e,n=(0,u.usePathname)(),{data:r}=(0,E.N)();return r?(0,i.BX)(i.HY,{children:[(0,i.tZ)("h3",{children:"방 목록"}),(0,i.tZ)(a.ZP,{children:(0,i.tZ)(P,{show:t,children:r.map(e=>{let t=n==="/room/".concat(e.id);return(0,i.tZ)(z(),{href:"/room/".concat(e.id),children:(0,i.tZ)("div",{className:"link_item ".concat(t?"active":""),children:e.title})},e.id)})})})]}):(0,i.tZ)("div",{children:"로딩중..."})}let P=(0,s.Z)("div",{target:"e1khsrg0"})("\r\n    display:flex;flex-direction:column;position:relative;gap:1rem;padding:0 1rem;margin-top:10px;transition:opacity 0s 0.2s;",e=>{let{show:t}=e;return!t&&"\n    transition-delay: 0.1s;\n    opacity: 0;\n    "},"\r\n\r\n    a{text-decoration:none;}.link_item{display:block;height:35px;line-height:35px;text-align:center;border-radius:5px;color:rgb(255,255,255,0.7);&.active,&:hover{background-color:#0058aa;}}");function R(e){let{show:t}=e,n=(0,u.usePathname)();return(0,i.BX)(X,{show:t,children:[(0,i.tZ)(z(),{href:"/my_page",children:(0,i.tZ)("div",{className:"link_item ".concat("/my_page"===n?"active":""),children:"프로필"})}),(0,i.tZ)(z(),{href:"/my_page/friends",children:(0,i.tZ)("div",{className:"link_item ".concat("/my_page/friends"===n?"active":""),children:"친구 목록"})}),(0,i.tZ)(z(),{href:"/my_page/my_picture",children:(0,i.tZ)("div",{className:"link_item ".concat("/my_page/my_picture"===n?"active":""),children:"저장된 사진들"})}),(0,i.tZ)(z(),{href:"/my_page/search",children:(0,i.tZ)("div",{className:"link_item ".concat("/my_page/search"===n?"active":""),children:"유저 검색"})})]})}let X=(0,s.Z)("div",{target:"emngarg0"})("\r\n    display:flex;flex-direction:column;position:relative;gap:1rem;padding:0 1rem;margin-top:60px;transition:opacity 0s 0.2s;",e=>{let{show:t}=e;return!t&&"\n    transition-delay: 0.1s;\n    opacity: 0;\n    "},"\r\n\r\n    a{text-decoration:none;}.link_item{display:block;height:35px;line-height:35px;text-align:center;border-radius:5px;color:rgb(255,255,255,0.7);&.active,&:hover{background-color:#0058aa;}}");function C(e){let{show:t,setLeftMenu:n}=e,[r]=(0,y.v$)(),a=(0,o.useCallback)(()=>n(!1),[n]);return(0,i.BX)(I,{show:t,children:[t&&(0,i.tZ)("div",{className:"close_icon",onClick:a,children:(0,i.tZ)(f.zrf,{})}),(null==r?void 0:r.currentPage)===w.L.ImageRoom?(0,i.tZ)(L,{show:t}):(0,i.tZ)(R,{show:t})]})}let I=(0,s.Z)("div",{target:"e189arda0"})("\r\n    position:relative;display:flex;flex-direction:column;width:200px;height:100%;padding:40px 0;box-sizing:border-box;transition:width 0.5s,opacity 0.4s;background-color:#99aebb;text-align:center;",e=>{let{show:t}=e;return!t&&"\n    width: 0;\n    opacity: 0;\n    "},"\r\n\r\n    .close_icon{position:absolute;z-index:1;right:10px;top:10px;padding:7px;border-radius:50%;background-color:lightgray;cursor:pointer;&:hover{background-color:darkgray;}}@media screen and (max-width:460px){position:absolute;z-index:10;}");var M=n(1298),A=(r=e=>{let{children:t,modal:n}=e,[r]=(0,y.v$)(),[s,c]=(0,o.useState)(!1);return(0,i.BX)("div",{style:{height:"inherit"},children:[(0,i.tZ)(k,{}),(0,i.BX)(U,{children:[(null==r?void 0:r.currentPage)!==w.L.RoomMain&&(0,i.tZ)(C,{show:s,setLeftMenu:c}),(0,i.BX)("main",{style:{flex:"1 0 auto",position:"relative"},children:[(null==r?void 0:r.currentPage)!==w.L.RoomMain&&!s&&(0,i.tZ)($,{onClick:()=>c(e=>!e),children:(0,i.tZ)(l.n5H,{})}),(0,i.tZ)(a.$B,{children:t})]})]}),n]})},e=>{let[t,n]=(0,y.v$)(),a=async()=>{let e=await (0,x.wt)();e?await n(t=>({...t,loginState:"login",user_info:{...e}})):await n(e=>({...e,loginState:"logout"}))};return((0,o.useEffect)(()=>{a()},[]),"logout"===t.loginState)?((0,x.RN)(),(0,u.redirect)("/login")):"loading"===t.loginState?(0,i.tZ)(M.Z,{}):(0,i.tZ)(r,{...e})});let U=(0,s.Z)("div",{target:"e1hevgz80"})("\r\n    display:flex;height:calc(100% - 50px);"),$=(0,s.Z)("div",{target:"e1hevgz81"})("\r\n    position:absolute;z-index:1;left:20px;top:10px;padding:7px;border-radius:50%;background-color:lightgray;cursor:pointer;&:hover{background-color:darkgray;}")},1298:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(7311);n(2265);var i=n(8067),o=n(3633),a=n.n(o);function l(){return(0,r.tZ)(s,{children:(0,r.tZ)(a(),{type:"spinningBubbles",color:"black"})})}let s=(0,i.Z)("div",{target:"e164e7r10"})("\r\n    height:100%;display:flex;align-items:center;justify-content:center;")},8760:function(e,t,n){"use strict";n.d(t,{N:function(){return d}});var r=n(2164),i=n(6881),o=n(4903),a=n(7262),l=n(6494),s=n(6339),c=n(2472);function d(){let[,e]=(0,l.v$)(),[t,n]=(0,i.ZP)({key:"".concat(l.EE,"-loading"),initial:!0}),[d,,u]=(0,i.ZP)({key:l.EE,initial:null,persistor:{onSet:a.Z.onSet,onGet:async t=>{try{let t=await (0,c.L)(),n=a.Z.onGet(l.sB),r=await o.Z.get("/user/".concat(n.user_info.id,"/roomlist"),{headers:{Authorization:t.access_token}}),i=r.data.roomlist.map(e=>{let t=e.userlist.map(e=>({id:e.id,name:e.name}));return{...e,userlist:t}});return e(e=>({...e,roomList:i})),i}catch(e){if(window.navigator.onLine){if(e instanceof r.d7){var i,d;if((null===(i=e.response)||void 0===i?void 0:i.status)===401||(null===(d=e.response)||void 0===d?void 0:d.status)===403)console.error("Error: 올바른 요청이 아닙니다..다시시도 해주세요!");else throw new s.U7}else throw new s.U7}throw new s.F7}finally{n(!1)}}}}),{mutate:h,error:p}=u,g=async e=>{let{userlist:t,title:i}=e;try{n(!0);let e=await (0,c.L)();await o.Z.post("/room",{userlist:t,title:i},{headers:{Authorization:e.access_token}}),h(),alert("성공적으로 방을 생성하였습니다!"),n(!1)}catch(e){if(e instanceof r.d7){var a,l;(null===(a=e.response)||void 0===a?void 0:a.status)===401||(null===(l=e.response)||void 0===l?void 0:l.status)===403?alert("올바른 요청이 아닙니다..다시시도 해주세요!"):alert("방 생성에 실패했습니다..다시시도 해주세요!")}else throw new s.U7}},m=async e=>{try{n(!0);let t=await (0,c.L)(),r=a.Z.onGet(l.sB);await o.Z.delete("/user/".concat(r.user_info.id,"/room"),{headers:{Authorization:t.access_token},data:{delete_user_room_id:e}}),h(),alert("성공적으로 방에서 나갔습니다!"),n(!1)}catch(e){if(e instanceof r.d7){var t,i;(null===(t=e.response)||void 0===t?void 0:t.status)===401||(null===(i=e.response)||void 0===i?void 0:i.status)===403?alert("올바른 요청이 아닙니다..다시시도 해주세요!"):alert("방에서 나가지 못하였습니다..다시시도 해주세요!")}else throw new s.U7}},v=async(e,t)=>{try{n(!0);let r=await (0,c.L)();await o.Z.post("/room/".concat(e,"/user"),{invite_userlist:t},{headers:{Authorization:r.access_token}}),h(),alert("성공적으로 초대하였습니다!"),n(!1)}catch(e){if(e instanceof r.d7){var i,a,l;if((null===(i=e.response)||void 0===i?void 0:i.status)===401||(null===(a=e.response)||void 0===a?void 0:a.status)===403)alert("올바른 요청이 아닙니다..다시시도 해주세요!");else if((null===(l=e.response)||void 0===l?void 0:l.status)===402)alert("방이 존재하지 않습니다...다시시도 해주세요!");else throw new s.U7}else throw new s.U7}},f=async(e,t)=>{try{n(!0);let r=await (0,c.L)();await o.Z.delete("/room/".concat(e,"/user"),{headers:{Authorization:r.access_token},data:{delete_room_user_id:t}}),h(),alert("성공적으로 강퇴하였습니다!"),n(!1)}catch(e){if(e instanceof r.d7){var i,a,l;if((null===(i=e.response)||void 0===i?void 0:i.status)===401||(null===(a=e.response)||void 0===a?void 0:a.status)===403)alert("올바른 요청이 아닙니다..다시시도 해주세요!");else if((null===(l=e.response)||void 0===l?void 0:l.status)===402)alert("방이 존재하지 않습니다..다시시도 해주세요!");else throw new s.U7}else throw new s.U7}};return{data:d,isLoading:t,error:p,createRoom:g,exitRoom:m,inviteMemberToRoom:v,forceOutMember:f}}},4903:function(e,t,n){"use strict";var r=n(9222);let i=r.default.create({baseURL:"https://codakcodak.site/backapi"});t.Z=i},3787:function(e,t,n){"use strict";var r,i;n.d(t,{L:function(){return r}}),(i=r||(r={})).RoomMain="RoomMain",i.ImageRoom="ImageRoom",i.MyPage="MyPage"},6339:function(e,t,n){"use strict";n.d(t,{F7:function(){return r},U7:function(){return i}});class r extends Error{constructor(e="연결되 네트워크가 없습니다."){super(e),this.name="NetworkError"}}class i extends Error{constructor(e="예기치 못한 에러가 발생하였습니다..다시 시도해주세요."){super(e),this.name="unknownError"}}},7262:function(e,t){"use strict";t.Z={onSet(e,t){let n=JSON.stringify(t);localStorage.setItem(String(e),n)},onGet(e){var t;let n=null!==(t=localStorage.getItem(String(e)))&&void 0!==t?t:"null";try{return JSON.parse(n)}catch(e){return n}}}},6494:function(e,t,n){"use strict";n.d(t,{B1:function(){return o},EE:function(){return l},sB:function(){return a},v$:function(){return d},wy:function(){return s},zV:function(){return c},zW:function(){return u}});var r=n(6881),i=n(7262);let o="@user/token",a="@user/info",l="@user/room",s="@user/friend",c="@user/image",d=(0,r.MT)({key:a,initial:{loginState:"loading"},persistor:i.Z}),u=(0,r.MT)({key:"".concat(c,"-imagelist"),initial:null})},2472:function(e,t,n){"use strict";n.d(t,{L:function(){return l}});var r=n(9222),i=n(2164),o=n(7262),a=n(6494);let l=async()=>{try{let e=new Date,t=o.Z.onGet(a.B1),n=null==t?void 0:t.access_token,i=null==t?void 0:t.refresh_token,l=null==t?void 0:t.access_token_expire_time,s=null==t?void 0:t.refresh_token_expire_time;if(!l||!s||!n)return null;let c=new Date(l),d=c.getTime()-e.getTime(),u=new Date(s),h=u.getTime()-e.getTime();if(d>=3e4)return t;if(!(h>=3e4))return null;{let e=o.Z.onGet(a.sB),n=null==e?void 0:e.user_info.id,l=await r.default.post("/backapi/user/".concat(n,"/refresh"),{refresh_token:i}),s=l.data;return o.Z.onSet(a.B1,{...t,...s}),s}}catch(e){return e instanceof i.d7?console.error("Error: 사용자 권한을 갱신하지 못하였습니다..",e):console.error("Error: ",e),null}}},452:function(e,t,n){"use strict";n.d(t,{R5:function(){return c},RN:function(){return d},eu:function(){return u},wt:function(){return h},x4:function(){return s}});var r=n(7262),i=n(6494),o=n(2164),a=n(4903),l=n(2472);let s=async e=>{let{email:t,password:n}=e;try{let e=await a.Z.post("/user/login",{email:t,password:n}),o=e.data;return r.Z.onSet(i.B1,o),!0}catch(e){if(e instanceof o.d7){var l,s,c;(null===(l=e.response)||void 0===l?void 0:l.status)===401||(null===(s=e.response)||void 0===s?void 0:s.status)===404?alert(null===(c=e.response)||void 0===c?void 0:c.data.message):alert("서버 문제로 잠시 후에 다시 시도 해주세요.")}else alert("예기치 못한 에러가 발생하였습니다..다시 시도해주세요.")}},c=async(e,t)=>{try{let n=await a.Z.get("/oauth-login/callback?coperation=".concat(e,"&code=").concat(t)),{user_id:o,...l}=n.data,s=await a.Z.get("/user/my",{headers:{Authorization:null==l?void 0:l.access_token}});r.Z.onSet(i.B1,l);let c=s.data.user_info;return c}catch(e){e instanceof o.d7?alert("서버 문제로 잠시 후에 다시 시도 해주세요."):alert("예기치 못한 에러가 발생하였습니다..다시 시도해주세요.");return}},d=()=>{window.localStorage.removeItem(i.sB),window.localStorage.removeItem(i.B1),window.localStorage.removeItem(i.EE),window.localStorage.removeItem(i.wy),window.localStorage.removeItem(i.zV)},u=async e=>{var t;try{let t=await (0,l.L)(),n=await a.Z.post("/user/my",{name:e},{headers:{Authorization:null==t?void 0:t.access_token}});return alert("성공적으로 변경하였습니다!"),n.data}catch(e){e instanceof o.d7?(null===(t=e.response)||void 0===t?void 0:t.status)===401?alert("사용자 권한이 없습니다..로그아웃 후 시도해주세요."):alert("서버 문제로 잠시 후에 다시 시도 해주세요."):alert("예기치 못한 에러가 발생하였습니다..다시 시도해주세요.")}},h=async()=>{var e;try{let e=await (0,l.L)();if(!e)throw Error();let t=await a.Z.get("/user/my",{headers:{Authorization:null==e?void 0:e.access_token}});return t.data.user_info}catch(t){return t instanceof o.d7&&((null===(e=t.response)||void 0===e?void 0:e.status)===401?console.error("Auth Error: ",t):console.error("Server Error: ",t)),null}}}},function(e){e.O(0,[2420,6115,3712,8447,2222,5104,2636,7311,6881,2164,3852,7263,1396,9147,2971,596,1744],function(){return e(e.s=4994)}),_N_E=e.O()}]);